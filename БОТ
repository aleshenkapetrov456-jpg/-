from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# –í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–æ–∫–µ–Ω –æ—Ç BotFather
BOT_TOKEN = "7958550643:AAGOaqQXnKxzKLnhM-1Lq8H4HOixWQW93lo"

YOUR_CHAT_ID = 1891586130  # –í–∞—à ID


async def forward_to_owner(update: Update, context: ContextTypes.DEFAULT_TYPE, bot_response: str = None):
    """–ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –≤–ª–∞–¥–µ–ª—å—Ü—É"""
    try:
        user_info = f"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {update.message.from_user.first_name}"
        user_message = f"üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ: {update.message.text}"

        full_text = f"{user_info}\n{user_message}"

        if bot_response:
            full_text += f"\nü§ñ –û—Ç–≤–µ—Ç –±–æ—Ç–∞: {bot_response}"

        await context.bot.send_message(chat_id=YOUR_CHAT_ID, text=full_text)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∏: {e}")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start
async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    response = "–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–¥–Ω–∏–º –æ—á–µ–Ω—å —É–º–Ω—ã–º –∏ —Ö–æ—Ä–æ—à–∏–π —á–µ–ª–æ–≤–µ–∫–æ–º! ‚âΩ^‚Ä¢‚©ä‚Ä¢^‚âº"
    await update.message.reply_text(response)
    await forward_to_owner(update, context, response)


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text.lower()

    bad_words = ["–±–ª—è—Ç—å", "–±–ª—è–¥—å", "—Å—É–∫–∞", "—Ö—É–π", "–ø–∏–∑–¥–∞", "–Ω–∞—Ö—É–π", "–ø–∏–¥–æ—Ä", "–ø–∏–¥–æ—Ä–∞—Å", "–ø–∏–¥–æ—Ä–∞—Å–∏–Ω–∞", "–ø–∏–∑–¥–µ—Ü"]
    greeting_words = ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π", "—Ö–∞–π", "hello", "hi", "—Å–∞–ª—é—Ç", "–±–æ–Ω–∂—É—Ä", "—Å–∞–ª–∞–º","—Å–∞–ø"]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –º–∞—Ç–µ—Ä–Ω—ã–µ —Å–ª–æ–≤–∞
    if any(bad_word in text for bad_word in bad_words):
        response = "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã—Ä–∞–∂–∞–π—Ç–µ—Å—å –≤–µ–∂–ª–∏–≤–æ! –ú–∞—Ç–µ—Ä–Ω—ã–µ —Å–ª–æ–≤–∞ –≤—ã–¥–∞—é—Ç –≤ –≤–∞—Å –Ω–µ–∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞."
        await update.message.reply_text(response)
        await forward_to_owner(update, context, response)
        return

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    if text in greeting_words:
        response = "–ü—Ä–∏–≤–µ—Ç —Å–Ω–æ–≤–∞! ‚âΩ^‚Ä¢‚©ä‚Ä¢^‚âº ‚ÇäÀö‚äπ‚ô°"
        await update.message.reply_text(response)
        await forward_to_owner(update, context, response)
        return

    # –î–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    response = "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –ø–æ–∫–∞ –Ω–µ –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –≤—ã —Å–µ–π—á–∞—Å –≥–æ–≤–æ—Ä–∏—Ç–µ"
    await update.message.reply_text(response)
    await forward_to_owner(update, context, response)


# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
def main():
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(BOT_TOKEN).build()

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(CommandHandler("start", start_command))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling()


if __name__ == "__main__":
    main()
